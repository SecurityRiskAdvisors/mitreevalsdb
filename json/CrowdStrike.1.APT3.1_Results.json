{"T1204": {"TechniqueName": "User Execution", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "DetectionCategories": [{"General Behavior": "A General Behavior alert for Machine Learning showed that Resume Viewer.exe was executed and that it was detected as malicious."}, {"Telemetry": "Telemetry within the alert showed that Resume Viewer.exe executed, and would also be available in a separate view.[CS8]"}], "Screenshots": {"CS-1.A.1-1.png": "Machine Learning General Behavior alert showing execution of Resume Viewer.exe and detection as malicious", "": ""}}}}, "T1064": {"TechniqueName": "Scripting", "TacticGroup": "Defense Evasion, Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "DetectionCategories": [{"General Behavior,Delayed": "OverWatch generated a General Behavior alert indicating the execution of pdfhelper.cmd was suspicious.[CS1]"}, {"Telemetry": "Telemetry showed pdfhelper.cmd being executed by cmd.exe."}], "Screenshots": {"CS-1.A.1-5.png": "OverWatch General Behavior alert indicating pdfhelper.cmd execution was suspicious", "CS-1.A.1-7.png": "Telemetry showing pdfhelper.cmd execution", "": ""}}, "11.A.1": {"Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated indicating \\\"A PowerShell script launched that shares characteristics with known PowerShell exploit kits.\\\""}, {"General Behavior,Delayed": "A General Behavior alert was generated from OverWatch indicating wscript.exe executing launcher.vbs was suspicious.[CS1] "}, {"Telemetry": "Telemetry within the OverWatch alert showed wscript.exe executing launcher.vbs, and would be available in a separate view.[CS2]"}, {"Specific Behavior,Delayed": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a malicious script invoked by wscript was run by Bob on CodeRed and launched PowerShell.[CS9]"}], "Screenshots": {"CS-11.A.1-1.png": "Specific Behavior alert for PowerShell sharing characteristics with known exploit kits", "CS-11.A.1-2.png": "General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious", "CS-E-6.png": "Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)", "": ""}}, "12.E.1": {"Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "DetectionCategories": [{"Telemetry": "Telemetry showed the PowerShell script (.ps1) being written to the temp folder."}, {"Specific Behavior,Delayed": "The OverWatch team generated a Specific Behavior alert indicating the PowerShell script was malicious.[CS1]"}, {"Specific Behavior,Delayed": "The OverWatch team also sent an email indicating they identified a Specific Behavior for an unidentified PowerShell script running.[CS9]"}], "Screenshots": {"CS-12.E.1-1.png": "Telemetry showing the temp write of the ps1 script", "CS-12.E.1-4.png": "OverWatch Specific Behavior alert indicating the PowerShell script was malicious", "CS-12.E.1-3.png": "Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)", "": ""}}}}, "T1085": {"TechniqueName": "Rundll32", "TacticGroup": "Defense Evasion, Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated due to rundll32 launching a suspended process. The alert was mapped to the correct ATT&CK Technique (Rundll32) and Tactic (Defense Evasion)."}, {"General Behavior, Delayed": "OverWatch generated a General Behavior alert indicating rundll32 executing update.dat was suspicious.[CS1]"}, {"Telemetry": "Telemetry within the OverWatch alert showed rundll32.exe executing, and would also be available in a separate view.[CS2]"}], "Screenshots": {"CS-1.A.1-6.png": "Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)", "CS-1.A.1-4.png": "OverWatch General Behavior alert indicating rundll32 execution was suspicious", "": ""}}}}, "T1060": {"TechniqueName": "Registry Run Keys / Startup Folder", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"1.B.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "DetectionCategories": [{"Telemetry": "Telemetry showed Registry activity related to the Startup folder. Though no screenshot of the file write is available, this data maybe indicative of modifications to the folder."}], "Screenshots": {"CS-1.B.1-1.png": "Telemetry showing Registry modification related to Startup Folder", "": ""}}, "10.A.1": {"Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"Telemetry": "Telemetry showed cmd.exe running autoupdate.bat from the Startup folder."}], "Screenshots": {"CS-10.A.1-1.png": "Telemetry showing cmd.exe running autoupdate.bat from Startup folder", "": ""}}}}, "T1043": {"TechniqueName": "Commonly Used Port", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using port 53", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though DNS requests for freegoogleadsenseinfo.com (C2 domain) were observed (no detection showed port 53 specifically)."}], "Screenshots": {"CS-1.C.1-1.png": "OverWatch alert showing suspicious DNS traffic (does not count as a detection)", "": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use port 80", "DetectionCategories": [{"Telemetry": "Telemetry showed a connection over TCP port 80 to 192.168.0.4 (C2 server)."}], "Screenshots": {"CS-6.C.1-1.png": "Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)", "": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using port 443", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe making connection to 192.168.0.5 (C2 server) over port 443. The telemetry was tainted by an alert on its parent powershell.exe process."}], "Screenshots": {"CS-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over port 443 (tainted by parent powershell.exe high severity alert indicated by red icon)", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "DetectionCategories": [{"Telemetry": "Telemetry showed a network connection event to 192.168.0.5 (C2 server) on TCP port 8080 that was associated with the encoded PowerShell IEX command."}], "Screenshots": {"CS-14.A.1-5.png": "Telemetry showing IEX connection over to 192.168.0.5 (C2 server) on TCP port 8080", "": ""}}}}, "T1071": {"TechniqueName": "Standard Application Layer Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated for abnormally large DNS requests for freegoogleadsenseinfo.com (C2 domain) being sent. The alert was mapped to a related ATT&CK Technique (Exfiltration Over Alternative Protocol) and Tactic (Exfiltration)."}, {"General Behavior, Delayed": "OverWatch also generated a General Behavior alert indicating the DNS traffic was suspicious.[CS1]"}, {"Telemetry": "Telemetry within the OverWatch alert showed the DNS requests, and would also be available in a separate view.[CS2]"}, {"Specific Behavior,Delayed": "The OverWatch team also sent an email indicating a Specific Behavior occurred because they observed suspected command and control or data exfiltration via DNS.[CS9]"}], "Screenshots": {"CS-1.C.1-2.png": "Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious", "CS-1.C.1-1.png": "Telemetry showing DNS requests", "CS-E-4.png": "Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)", "": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed a connection to 192.168.0.4 (C2 server) on port 80 (no detection showed HTTP specifically)."}], "Screenshots": {"": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic)."}], "Screenshots": {"CS-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080."}], "Screenshots": {"CS-14.A.1-6.png": "Telemetry showing encoded PowerShell command that decodes to show HTTP traffic (does not count as a detection)", "CS-14.A.1-7.png": "Decoded PowerShell (outside of capability) showing download request over HTTP (does not count as a detection)", "": ""}}}}, "T1132": {"TechniqueName": "Data Encoding", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed the base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Exfiltration alert."}], "Screenshots": {"CS-1.C.1-2.png": "Telemetry within an alert showing encoded DNS requests (tainted by parent Exfiltration alert)", "": ""}}}}, "T1059": {"TechniqueName": "Command-Line Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.3": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "6.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "7.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.F.1": {"Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00a0", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed a new cmd.exe process running wscript.exe as user Kmitnick, which then launched powershell.exe. The command line arguments for cmd.exe showed that autoupdate.vbs was run. The telemetry was tainted by a previous detection."}], "Screenshots": {"CS-16.F.1-1.png": "Telemetry showing cmd.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)", "CS-16.F.1-2.png": "Telemetry showing wscript.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)", "": ""}}}}, "T1016": {"TechniqueName": "System Network Configuration Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.A.1": {"Procedure": "Cobalt Strike: 'ipconfig /all' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing ipconfig with command-line arguments. The process tree showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran ipconfig) were considered tainted and suspicious."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because ipconfig was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.A.1-2.png": "Telemetry showing ipconfig with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (ipconfig not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating ipconfig was a reconnaissance command (General Behavior)", "": ""}}, "2.A.2": {"Procedure": "Cobalt Strike: 'arp -a' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing arp with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran arp) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because arp was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.A.2-1.png": "Telemetry showing arp with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (arp not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating arp was a reconnaissance command (General Behavior)", "": ""}}, "4.B.1": {"Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "DetectionCategories": [{"General Behavior,Delayed": "OverWatch generated a General Behavior alert indicating the execution of netsh by cmd.exe was suspicious.[CS1] "}, {"Telemetry": "Telemetry within the OverWatch alert showed netsh executing with command-line arguments, and would be available in a separate view.[CS2]"}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because netsh was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-4.B.1-1.png": "OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious", "CS-E-3.png": "Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)", "": ""}}, "12.A.1": {"Procedure": "Empire: 'route print' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The process tree view showed route.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because route print was part of the basic reconnaissance activity performed.[CS9]"}], "Screenshots": {"CS-12.A.1-1.png": "Telemetry from process tree showing route.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-6.png": "Email excerpt from the OverWatch team indicating route print was part of basic reconnaissance activity (General Behavior)", "": ""}}, "12.A.2": {"Procedure": "Empire: 'ipconfig /all' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The process tree view showed ipconfig.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because ipconfig was part of the basic reconnaissance activity performed.[CS9]"}], "Screenshots": {"CS-12.A.1-2.png": "Telemetry from process tree showing ipconfig.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-6.png": "Email excerpt from the OverWatch team indicating ipconfig was part of basic reconnaissance activity (General Behavior)", "": ""}}, "12.E.1.11": {"Procedure": "Empire: WinEnum module included enumeration of network adapters", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1033": {"TechniqueName": "System Owner/User Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.B.1": {"Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing echo with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran echo) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because echo was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.B.1-1.png": "Telemetry showing echo with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (echo not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating echo was a reconnaissance command (General Behavior)", "": ""}}, "12.B.1": {"Procedure": "Empire: 'whoami /all /fo list' via PowerShell", "DetectionCategories": [{"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating whoami.exe with command-line arguments was suspicious. The process tree view showed whoami.exe as tainted by a previous powershell.exe detection.[CS1] "}, {"Telemetry": "Telemetry within the OverWatch alert showed powershell.exe executing whoami.exe with command-line arguments, and would be available in a separate view.[CS2]"}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because whoami was part of the basic reconnaissance activity performed.[CS9]"}], "Screenshots": {"CS-12.B.1-1.png": "OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-6.png": "Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)", "": ""}}, "12.E.1.1": {"Procedure": "Empire: WinEnum module included enumeration of user information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "20.B.1": {"Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry, Tainted": "Telemetry showed execution of whoami.exe. The process tree view showed whoami.exe was tainted by a previous magnify.exe detection."}], "Screenshots": {"CS-20.B.1-1.png": "Telemetry from process tree showing magnify.exe child process whoami.exe (tainted by pink line indicating critical severity)", "": ""}}}}, "T1106": {"TechniqueName": "Execution through API", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "3.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1057": {"TechniqueName": "Process Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.C.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "Cobalt Strike: 'tasklist /v' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran tasklist) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because tasklist was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.B.1-1.png": "Telemetry showing tasklist with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (tasklist not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating tasklist was a reconnaissance command (General Behavior)", "": ""}}, "3.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "Empire: 'qprocess *' via PowerShell", "DetectionCategories": [{"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating qprocess.exe with command-line arguments was suspicious. The process tree view showed qprocess.exe as tainted by a previous powershell.exe detection.[CS1] "}, {"Telemetry": "Telemetry within the OverWatch alert showed execution of qprocess.exe with command-line arguments, and would be available in a separate view.[CS2]"}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because qprocess was part of the basic reconnaissance activity performed performed.[CS9]"}], "Screenshots": {"CS-12.C.1-1.png": "OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-6.png": "Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)", "": ""}}}}, "T1007": {"TechniqueName": "System Service Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.D.1": {"Procedure": "Cobalt Strike: 'sc query' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing sc with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran sc) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because sc query was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.B.1-1.png": "Telemetry showing sc with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (sc query not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating sc query was a reconnaissance command (General Behavior)", "": ""}}, "2.D.2": {"Procedure": "Cobalt Strike: 'net start' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted."}], "Screenshots": {"CS-2.D.2-1.png": "Telemetry showing net with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net start not specifically shown)", "": ""}}, "12.D.1": {"Procedure": "Empire: 'net start' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted ": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe and net1.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net start was part of the basic reconnaissance activity performed performed.[CS9]"}], "Screenshots": {"CS-12.D.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-6.png": "Email excerpt from the OverWatch team indicating net start was part of basic reconnaissance activity (General Behavior)", "": ""}}, "12.E.1.8": {"Procedure": "Empire: WinEnum module included enumeration of services", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "16.H.1": {"Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed execution of sc.exe to query services on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection."}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed because the user Bob was querying for a particular service on Creeper.[CS9]"}], "Screenshots": {"CS-16.H.1-1.png": "Telemetry from process tree showing sc.exe execution to query services on Creeper (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service on Creeper (Specific Behavior)", "": ""}}, "16.J.1": {"Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed sc.exe executing with command-line arguments to query the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection."}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating they observed a Specific Behavior because the user Bob queried for a particular service on Creeper.[CS9]"}], "Screenshots": {"CS-16.J.1-1.png": "Telemetry showing sc.exe execution to query the AdobeUpdater service on Creeper process tree view (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed Bob querying for a service (Specific Behavior)", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The process tree view showed reg.exe as tainted by a previous powershell.exe detection."}], "Screenshots": {"CS-17.A.1-1.png": "Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "": ""}}}}, "T1082": {"TechniqueName": "System Information Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.E.1": {"Procedure": "Cobalt Strike: 'systeminfo' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing systeminfo. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran systeminfo) were considered tainted."}, {"General Behavior,Delayed": "OverWatch also generated a General Behavior alert indicating systeminfo execution was suspicious.[CS1]"}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because systeminfo was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.D.2-1.png": "Telemetry showing systeminfo", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)", "CS-2.E.1-1.png": "OverWatch General Behavior alert indicating systeminfo.exe was suspicious", "CS-E-3.png": "Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)", "": ""}}, "2.E.2": {"Procedure": "Cobalt Strike: 'net config workstation' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because net config was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.D.2-1.png": "Telemetry showing net with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net config not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net config was a reconnaissance command (General Behavior)", "": ""}}, "12.E.1.6.1": {"Procedure": "Empire: WinEnum module included enumeration of system information", "DetectionCategories": [{"Telemetry": "Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function."}], "Screenshots": {"CS-12.E.1.6.1-1.png": "Telemetry showing the Get-Sysinfo function", "": ""}}, "12.E.1.6.2": {"Procedure": "Empire: WinEnum module included enumeration of Windows update information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1069": {"TechniqueName": "Permission Groups Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.F.1": {"Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted."}, {"General Behavior,Delayed": "OverWatch also generated a General Behavior alert indicating net localgroup execution was suspicious.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.F.1-1.png": "Telemetry showing net with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)", "CS-2.F.1-3.png": "OverWatch General Behavior alert for net localgroup ", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)", "": ""}}, "2.F.2": {"Procedure": "Cobalt Strike: 'net localgroup administrators /domain' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.F.1-1.png": "Telemetry showing net with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)", "": ""}}, "2.F.3": {"Procedure": "Cobalt Strike: 'net group \"Domain Admins\" /domain' via cmd", "DetectionCategories": [{"Enrichment,Tainted": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The enrichment was tainted by a previous detection."}, {"Telemetry,Tainted": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.F.1-2.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)", "CS-2.F.1-1.png": "Telemetry showing net with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)", "": ""}}, "12.E.1.2": {"Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.F.1": {"Procedure": "Empire: 'net group \"Domain Admins\" /domain' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection."}, {"Enrichment,Tainted": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed net.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-12.F.1-3.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-12.F.1-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)", "": ""}}, "12.F.2": {"Procedure": "Empire: 'net\u00a0localgroup\u00a0administrators' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-12.F.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net localgroup was part of additional malicious discovery activity (General Behavior)", "": ""}}}}, "T1087": {"TechniqueName": "Account Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.G.1": {"Procedure": "Cobalt Strike: 'net user /domain' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net.exe) were considered tainted."}], "Screenshots": {"CS-2.G.1-1.png": "Telemetry showing net with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)", "": ""}}, "2.G.2": {"Procedure": "Cobalt Strike: 'net user george /domain' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net user was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.G.1-1.png": "Telemetry showing net with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net user was a reconnaissance command (General Behavior)", "": ""}}, "7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "DetectionCategories": [{"Telemetry": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information."}], "Screenshots": {"CS-6.C.1-4.png": "Telemetry showing mmc.exe running lursmgr.msc", "": ""}}, "12.G.1": {"Procedure": "Empire: 'net user' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-12.G.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)", "": ""}}, "12.G.2": {"Procedure": "Empire: 'net user /domain' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-12.G.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)", "": ""}}}}, "T1012": {"TechniqueName": "Query Registry", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.H.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing reg with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran reg) were considered tainted."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because reg query was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-2.G.1-1.png": "Telemetry showing reg with command-line arguments", "CS-2.A.1-1.png": "Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (reg query not specifically shown)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating reg query was a reconnaissance command (General Behavior)", "": ""}}, "6.A.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the parent cmd.exe process."}, {"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating the reg query command was suspicious. The alert was tainted by the parent cmd.exe process.[CS1] "}], "Screenshots": {"CS-6.A.1-1.png": "Telemetry showing reg with command-line arguments", "CS-6.A.1-2.png": "OverWatch General Behavior alert identifying reg query as suspicious as well as reg.exe process (tainted by previous detection by orange line indicating medium severity)", "": ""}}, "12.E.1.7": {"Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "DetectionCategories": [{"Telemetry": "Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function."}], "Screenshots": {"CS-12.E.1.6.1-1.png": "Telemetry showing the Get-Sysinfo function", "": ""}}, "13.C.1": {"Procedure": "Empire:\u00a0'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert identifying reg.exe execution as suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]"}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because reg query was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-13.C.1-4.png": "Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-13.C.1-2.png": "OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)", "CS-13.C.1-3.png": "OverWatch General Behavior alert indicating reg query was suspicious", "CS-E-8.png": "Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection."}], "Screenshots": {"CS-17.A.1-1.png": "Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "": ""}}}}, "T1134": {"TechniqueName": "Access Token Manipulation", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "5.B.1": {"Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "DetectionCategories": [{"Telemetry": "Telemetry showed the compromised process (21898821890) running as Debbie, then children from this process spawning first as Debbie and later as George. This could indicate theft of George's token within the context of the process."}], "Screenshots": {"CS-5.B.1-1.png": "Telemetry showing children of the compromised process (PID 21898821890) first running as Debbie, then as George", "": ""}}}}, "T1088": {"TechniqueName": "Bypass User Account Control", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "DetectionCategories": [{"Telemetry": "Telemetry showed an integrity level change for user Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High), which is indicative of bypassing UAC. "}], "Screenshots": {"CS-3.A.1-1.png": "Telemetry showing process integrity level change for Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High)", "": ""}}, "14.A.1": {"Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "DetectionCategories": [{"Telemetry": "Telemetry showed an integrity level change through a query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000), which is indicative of bypassing UAC. Telemetry also showed the Invoke-BypassUACTokenManipulation function in the script."}, {"Specific Behavior,Delayed": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a base64 obfuscated PowerShell command was used to invoke UAC bypass.[CS9]"}], "Screenshots": {"CS-14.A.1-9.png": "Telemetry showing integrity level change through query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000)", "CS-14.A.1-4.png": "Telemetry showing the Invoke-BypassUACTokenManipulation function", "CS-E-8.png": "Email excerpt from the OverWatch team indicating obfuscated PowerShell invoked UAC bypass (Specific Behavior)", "": ""}}}}, "T1055": {"TechniqueName": "Process Injection", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.C.1": {"Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "DetectionCategories": [{"Specific Behavior,Tainted": "A Specific Behavior alert was generated showing that PowerShell created a thread into a remote process. The alert identified the correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion). The process tree view showed the alert as tainted by parent svchost.exe and powershell.exe detections."}, {"Telemetry": "Telemetry associated with the alert would show thread creation in a separate view.[CS8]"}, {"General Behavior,Delayed,Tainted": "OverWatch also generated a General Behavior alert identifying the injection as suspicious. The process tree view showed the alert as tainted by previous svchost.exe and powershell.exe detections.[CS1] "}], "Screenshots": {"CS-3.C.1-1.png": "Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious", "CS-3.C.1-2.png": "Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)", "": ""}}, "5.A.1": {"Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "DetectionCategories": [{"Enrichment": "The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), as well as an lsass process accessed (ProcessHollowingDetected)."}], "Screenshots": {"CS-5.A.1-8.png": "Enrichment showing ReflectiveDllOpenLsass and ProcessHollowingDetected events", "": ""}}, "5.A.2": {"Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "DetectionCategories": [{"Enrichment": "The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), malicious process hollowing (ProcessHollowingDetected), and a remote process injecting code into lsass (LsassInjectedCode)."}], "Screenshots": {"CS-5.A.2-5.png": "Enrichment showing ReflectiveDllOpenLsass, ProcessHollowingDetected, and LsassInjectedCode events", "": ""}}, "8.D.1": {"Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "DetectionCategories": [{"Telemetry": "Telemetry showed InjectedThread events for explorer.exe (pid=21776848613) injecting from cmd.exe (pid=21898821890), which is a known beacon."}], "Screenshots": {"CS-8.D.1-2.png": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890)", "": ""}}}}, "T1018": {"TechniqueName": "Remote System Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.A.1": {"Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery)."}, {"Telemetry": "Telemetry within the enrichment showed net.exe executing with command-line arguments, and would be available in a separate view.[CS8]"}, {"General Behavior,Delayed": "OverWatch also generated a General Behavior alert identifying cmd.exe executing net as suspicious.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-4.A.1-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)", "CS-4.A.1-2.png": "Additional process tree view showing net.exe enrichment", "CS-4.A.1-3.png": "OverWatch General Behavior alert for net group", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)", "": ""}}, "4.A.2": {"Procedure": "Cobalt Strike: 'net group \"Domain Computers\" /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery)."}, {"Telemetry": "Telemetry within the enrichment showed net.exe with command-line arguments, and would be available in a separate view.[CS8]"}, {"General Behavior,Delayed": "The OverWatch team identified net group as suspicious with a General Behavior alert.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-4.A.2-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)", "CS-4.A.2-2.png": "Additional process tree view showing net.exe enrichment", "CS-4.A.2-3.png": "OverWatch General Behavior alert for net group ", "CS-E-3.png": "Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)", "": ""}}, "13.A.1": {"Procedure": "Empire: 'net group \"Domain Computers\" /domain' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection."}, {"Enrichment,Tainted": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed the enrichment was tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": " The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-13.A.1-2.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-13.A.1-1.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)", "": ""}}}}, "T1049": {"TechniqueName": "System Network Connections Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.C.1": {"Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "DetectionCategories": [{"General Behavior,Delayed": "OverWatch generated a General Behavior alert indicating cmd.exe executing netstat with command-line arguments was suspicious.[CS1] "}, {"Telemetry": "Telemetry within the OverWatch alert showed cmd.exe executing netstat with command-line arguments, and would be available in a separate view.[CS2]"}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because netstat was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-4.C.1-1.png": "OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious", "CS-E-3.png": "Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)", "": ""}}, "12.E.1.12": {"Procedure": "Empire: WinEnum module included enumeration of established network connections", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection."}], "Screenshots": {"CS-12.E.12-2.png": "Telemetry from process tree showing netstat.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)", "": ""}}, "13.B.1": {"Procedure": "Empire: 'net use' via PowerShell", "DetectionCategories": [{"Telemetry, Tainted": "Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": " The OverWatch team sent an email indicating a General Behavior was observed because net use was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-13.B.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating net use was part of additional malicious discovery activity (General Behavior)", "": ""}}, "13.B.2": {"Procedure": "Empire: 'netstat -ano' via PowerShell", "DetectionCategories": [{"Telemetry, Tainted": "Telemetry showed netstat.exe executing with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": " The OverWatch team sent an email indicating a General Behavior was observed because netstat was part of additional malicious discovery performed.[CS9]"}], "Screenshots": {"CS-13.B.2-1.png": "Telemetry from process tree showing netstat.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-8.png": "Email excerpt from the OverWatch team indicating netstat was part of additional malicious discovery activity (General Behavior)", "": ""}}}}, "T1003": {"TechniqueName": "Credential Dumping", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"5.A.1": {"Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "DetectionCategories": [{"Specific Behavior,Tainted": "A Specific Behavior alert was generated for Credential Dumping, which indicated \\\"a DLL was detected as being reflectively loaded in the callstack.\\\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection."}, {"Telemetry": "Telemetry showing the lsass handle open and DLL loading would be available in a separate view.[CS8]"}, {"General Behavior,Delayed,Tainted": "A General Behavior alert was generated by the OverWatch team indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a parent detection.[CS1] "}], "Screenshots": {"CS-5.A.1-6.png": "Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )", "": ""}}, "5.A.2": {"Procedure": "Cobalt Strike: Built-in hash dump capability executed", "DetectionCategories": [{"Specific Behavior,Tainted": "A Specific Behavior alert was generated for Credential Dumping, which indicated \\\"a DLL was detected as being reflectively loaded in the callstack.\\\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection."}, {"Specific Behavior,Tainted": "A second Specific Behavior alert was generated for Credential Dumping, which indicated that \\\"a remote thread in LSASS accessed credential registry keys.\\\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection."}, {"Telemetry": "Telemetry for the lsass remote thread and DLL loading would be available in a separate view.[CS8]"}, {"General Behavior,Delayed,Tainted": "OverWatch also generated a General Behavior alert indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a previous detection.[CS1] "}], "Screenshots": {"CS-5.A.2-1.png": "Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert", "CS-5.A.2-4.png": "Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )", "": ""}}}}, "T1026": {"TechniqueName": "Multiband Communication", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed connections over both DNS and TCP port 80, which could indicate multiband communication. The DNS connections were tainted by a parent Exfiltration alert."}], "Screenshots": {"CS-1.C.1-2.png": "Telemetry within an alert showing abnormally large DNS requests occurred (tainted by parent Exfiltration alert)", "CS-6.C.1-1.png": "Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)", "": ""}}}}, "T1076": {"TechniqueName": "Remote Desktop Protocol", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"6.C.1": {"Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed a connection for logon type 10 (interactive logon) and a connection to 10.0.0.5 (Conficker) over TCP port 3389."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because they identified suspicious communications over port 3389 (RDP) to other hosts.[CS9]"}], "Screenshots": {"CS-6.C.1-3.png": "Telemetry showing logon type 10 (interactive remote login) as user George@shockwave on 10.0.0.5 (Conficker)", "CS-6.C.1-5.png": "Telemetry showing a network connection to 10.0.0.5 (Conficker) over TCP port 3389", "CS-E-1.png": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)", "": ""}}, "10.B.1": {"Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "DetectionCategories": [{"Telemetry": "Telemetry showed the remote connection to Conficker for a user logon by Jesse with type 10 (interactive) as well as the use of rdpclip.exe by the logged-on user."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior occurred because they observed suspicious communications over 3389 (RDP) to other hosts.[CS9]"}], "Screenshots": {"CS-10.B.1-1.png": "Telemetry showing user logon by Jesse to Conficker with type 10 (interactive logon)", "CS-10.B.1-2.png": "Telemetry showing logged-on user activity, including the use of rdpclip.exe", "CS-E-1.png": "Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)", "": ""}}, "20.A.1": {"Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "DetectionCategories": [{"Telemetry": "Telemetry showed a logon type 10 (remote interactive logon) for Kmitnick on Creeper, indicating a RDP session was established and logged into."}], "Screenshots": {"CS-20.A.1-3.png": "Telemetry showing logon type 10 (remote interactive logon) for Kmitnick on Creeper", "": ""}}}}, "T1136": {"TechniqueName": "Create Account", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "DetectionCategories": [{"Telemetry": "Telemetry showed the creation of the user Jesse and the user being added to the domain admin group."}], "Screenshots": {"CS-7.A.1-1.png": "Telemetry showing creation of the user Jesse with the user RID 000003E8", "CS-7.A.1-2.png": "Telemetry showing user RID 000003E8 (corresponding to the user Jesse) added to the admin group (00000220), a well-known security identifier", "CS-7.A.1-3.png": "Telemetry showing group membership of the user Jesse, including Remote (0000022B), Admins (00000220), and Users (00000221), which are well-known security identifiers", "": ""}}}}, "T1061": {"TechniqueName": "Graphical User Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "DetectionCategories": [{"Telemetry": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in)."}], "Screenshots": {"CS-6.C.1-4.png": "Telemetry showing mmc.exe running lursmgr.msc", "": ""}}}}, "T1105": {"TechniqueName": "Remote File Copy", "TacticGroup": "Command and Control, Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"7.B.1": {"Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed the file write for updater.dll into the system32 folder by user George. The telemetry was tainted by the parent \\\"unexpected process\\\" alert."}], "Screenshots": {"CS-7.B.1-1.png": "Telemetry showing file write for updater.dll (tainted by the parent \\\"unexpected process\\\" alert)", "CS-7.B.1-2.png": "Additional telemetry showing\u00a0file write for updater.dll", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "DetectionCategories": [{"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed because PowerShell retrieved the file wdbypass from www.freegoogleadsenseinfo.com (C2 domain) over port 8080.[CS9]"}], "Screenshots": {"CS-E-11.png": "Email excerpt from the OverWatch team indicating PowerShell retrieved the file wdbypass (Specific Behavior)", "": ""}}, "16.E.1": {"Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed File Write and New Script Write events for autoupdate.vbs under powershell.exe. The telemetry was tainted by a previous detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because a .vbs was written to the filesystem, which was likely used to carry out additional actions.[CS9]"}], "Screenshots": {"CS-16.E.1-1.png": "Telemetry showing File Write and New Script Write for autoupdate.vbs within powershell.exe (tainted by previous detection by orange line indicating medium severity)", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating they observed autoupdate.vbs written (General Behavior)", "": ""}}, "16.G.1": {"Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed update.vbs written to the C$ remote share on host 10.0.0.4 (Creeper)."}], "Screenshots": {"CS-16.G.1-1.png": "Telemetry showing update.vbs with event_name NewScriptWritten indicating a write to C$", "": ""}}, "19.A.1": {"Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed file write of recycler.exe by powershell.exe as well as the network connection over which the download occurred. The process tree view showed the parent powershell.exe process as tainted by a previous wscript.exe detection."}], "Screenshots": {"CS-19.A.1-1.png": "Telemetry showing file write of recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)", "CS-19.A.1-3.png": "Telemetry showing network connection from 192.168.0.5 (C2 server) used by powershell.exe to transfer recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)", "": ""}}}}, "T1053": {"TechniqueName": "Scheduled Task", "TacticGroup": "Execution, Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"7.C.1": {"Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "DetectionCategories": [{"Telemetry": "Telemetry showed the creation of the scheduled task."}, {"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating the creation of the scheduled task was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.[CS1] "}, {"Specific Behavior,Delayed": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a scheduled task was created for persistence.[CS9]"}], "Screenshots": {"CS-7.C.1-2.png": "Telemetry showing creation of the scheduled task", "CS-7.C.1-3.png": "General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)", "CS-E-4.png": "Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)", "": ""}}, "10.A.2": {"Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed rundll32.exe starting updater.dll. The telemetry was tainted by the parent OverWatch alert."}], "Screenshots": {"CS-10.A.2-2.png": "Telemetry showing rundll32.exe executing updater.dll (tainted by the parent OverWatch alert)", "": ""}}}}, "T1083": {"TechniqueName": "File and Directory Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.A.1": {"Procedure": "Cobalt Strike: 'dir /s /b \"\\\\conficker\\wormshare\"' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe running dir. The process tree view showed the cmd.exe process that ran dir as tainted by a prior detection."}], "Screenshots": {"CS-8.A.1-1.png": "Telemetry showing cmd.exe running dir with command-line arguments (search was on commands running within the past 10 minutes)", "CS-8.A.1-2.png": "Process tree view showing cmd.exe that ran dir (dir not specifically shown, cmd.exe is second from top and tainted by previous detection by orange line indicating medium severity)", "": ""}}, "8.A.2": {"Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed cmd.exe running tree with command-line arguments. The process tree view also showed the cmd.exe that was the parent for tree.com as tainted by a prior detection."}, {"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating tree.com was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was identified because tree was one of the reconnaissance commands performed.[CS9]"}], "Screenshots": {"CS-8.A.1-1.png": "Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)", "CS-8.A.1-2.png": "OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)", "CS-8.A.2-2.png": "Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)", "CS-E-3.png": "Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)", "": ""}}, "9.A.1": {"Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.4.1": {"Procedure": "Empire: WinEnum module included enumeration of recently opened files", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.4.2": {"Procedure": "Empire: WinEnum module included enumeration of interesting files", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "16.K.1": {"Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "18.A.1": {"Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1056": {"TechniqueName": "Input Capture", "TacticGroup": "collection, Credential Access", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed explorer.exe injecting from a known beacon (does not detect input capture specifically)."}], "Screenshots": {"CS-8.C.1-1.png": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)", "": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "DetectionCategories": [{"Telemetry": "Telemetry showed a file read event for IT_tasks.txt by powershell.exe as well as a FsPostOpen event indicating IT_tasks.txt was opened."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because IT_tasks.txt was retrieved from a network share as a file of interest.[CS9]"}], "Screenshots": {"CS-15.B.1-2.png": "Telemetry showing file read event for IT_tasks.txt", "CS-15.B.1-1.png": "Telemetry showing FsPostOpen event for IT_tasks.txt", "CS-E-12.png": "Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)", "": ""}}}}, "T1010": {"TechniqueName": "Application Window Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "DetectionCategories": [{"Telemetry": "Telemetry showed the decoded PowerShell script, which displayed the API call GetForegroundWindow to enumerate the active window."}], "Screenshots": {"CS-15.A.1-2.png": "Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow", "": ""}}}}, "T1113": {"TechniqueName": "Screen Capture", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"8.D.1": {"Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed explorer.exe injecting from a known beacon (does not detect screen capture specifically)."}], "Screenshots": {"CS-8.D.1-2.png": "Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)", "": ""}}}}, "T1039": {"TechniqueName": "Data from Network Shared Drive", "TacticGroup": "collection", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry was available for the write file of the .vsdx into the Recycle Bin (no data was available that indicated it came from a network shared drive). "}], "Screenshots": {"": ""}}}}, "T1041": {"TechniqueName": "Exfiltration Over Command and Control Channel", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1078": {"TechniqueName": "Valid Accounts", "TacticGroup": "Defense Evasion, Persistence, Privilege Escalation, Initial Access", "PrimaryEnabling": "Primary", "Steps": {"10.B.1": {"Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "DetectionCategories": [{"Telemetry": "Telemetry showed a type 10 (interactive) UserLogon event for Jesse."}], "Screenshots": {"CS-10.B.1-1.png": "Telemetry showing user logon by Jesse to Conficker", "": ""}}, "16.B.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection."}, {"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]\u00a0"}], "Screenshots": {"CS-16.B.1-1.png": "Telemetry from process tree showing successful net.exe connection using valid credentials of Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)", "CS-16.B.1-2.png": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)", "": ""}}, "16.D.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on Creeper as the user Kmitnick. The process tree view showed net.exe as tainted by a previous powershell.exe detection."}], "Screenshots": {"CS-16.D.1-2.png": "Telemetry showing successful net use connection by Kmitnick in the process tree view (tainted by previous powershell.exe detection by red line indicating high severity)", "": ""}}}}, "T1086": {"TechniqueName": "PowerShell", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"11.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "15.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.I.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.J.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.K.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.L.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1032": {"TechniqueName": "Standard Cryptographic Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"11.B.1": {"Procedure": "Empire: Encrypted C2 channel established using HTTPS", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic)."}], "Screenshots": {"CS-11.B.1-1.png": "Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)", "": ""}}}}, "T1201": {"TechniqueName": "Password Policy Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.3": {"Procedure": "Empire: WinEnum module included enumeration of password policy information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1115": {"TechniqueName": "Clipboard Data", "TacticGroup": "collection", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.5": {"Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed execution of an encoded PowerShell command and OverWatch alerted on it as suspicious. The PowerShell decoded to Windows.Clipboard(...) outside of the capability, which indicated clipboard interaction, but this was not counted as a detection because it was external to the capability."}], "Screenshots": {"CS-12.E.1-2.png": "Telemetry showing encoded PowerShell, which decodes to show Windows.Clipboard details (does not count as a detection)", "CS-12.E.1.5-3.png": "Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)", "CS-12.E.1.5-1.png": "OverWatch alert indicating encoded PowerShell was suspicious (does not count as a detection)", "": ""}}}}, "T1135": {"TechniqueName": "Network Share Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.9.1": {"Procedure": "Empire: WinEnum module included enumeration of available shares", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.9.2": {"Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1063": {"TechniqueName": "Security Software Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.10.1": {"Procedure": "Empire: WinEnum module included enumeration of AV solutions", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.10.2": {"Procedure": "Empire: WinEnum module included enumeration of firewall rules", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1081": {"TechniqueName": "Credentials in Files", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"15.B.1": {"Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed the decoded PowerShell script, which displayed the function Get-Keystrokes."}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was identified because they observed the adversary logging keystrokes based on the GetKeystrokes PowerShell function.[CS9]"}], "Screenshots": {"CS-15.A.1-2.png": "Telemetry showing decoded PowerShell script containing the function Get-Keystrokes", "CS-E-8.png": "Excerpt from email sent by OverWatch team indicating keylogging activity occurred (Specific Behavior)", "": ""}}}}, "T1110": {"TechniqueName": "Brute Force", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00a0Kmitnick, Bob, and Frieda", "DetectionCategories": [{"Telemetry": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying, including details that the logons were for local admin (type 6) and that they failed."}, {"General Behavior,Delayed,Tainted": "OverWatch generated General Behavior alerts indicating the net use commands were suspicious. The alerts were tainted by a parent powershell.exe detection.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.[CS9]"}], "Screenshots": {"CS-16.A.1-1.png": "Telemetry showing net.exe logon attempts", "CS-16.A.1-3.png": "Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)", "CS-16.A.1-4.png": "Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)", "CS-16.A.1-2.png": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed net.exe executing with command-line arguments to connect as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection."}, {"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.[CS9]"}], "Screenshots": {"CS-16.B.1-1.png": "Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)", "CS-16.B.1-2.png": "OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)", "": ""}}}}, "T1077": {"TechniqueName": "Windows Admin Shares", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "DetectionCategories": [{"Telemetry": "Telemetry showed repeated logon attempts via net.exe with command-line arguments targeting ADMIN$ shares on the machines 10.0.1.4 (Morris) and 10.0.1.6 (Nimda)."}, {"General Behavior,Delayed,Tainted": "OverWatch generated General Behavior alerts indicating the net use commands attempting logon to ADMIN$ shares were suspicious. The alerts were tainted by a parent powershell.exe detection.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]"}], "Screenshots": {"CS-16.A.1-1.png": "Telemetry showing net use logon attempts to ADMIN$ shares", "CS-16.A.1-2.png": "Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00a0", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect to ADMIN$ on 10.0.0.5 (Conficker) as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating the successful net use connection to ADMIN$ was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1] "}, {"General Behavior,Delayed": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]"}], "Screenshots": {"CS-16.B.1-1.png": "Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)", "CS-16.B.1-2.png": "OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)", "": ""}}, "16.D.1": {"Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on 10.0.0.4 (Creeper) as the user Kmitnick. The telemetry was tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": " The OverWatch team sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]"}], "Screenshots": {"CS-16.D.1-2.png": "Telemetry showing process tree containing successful net use connection to C$ (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)", "": ""}}}}, "T1126": {"TechniqueName": "Network Share Connection Removal", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.C.1": {"Procedure": "Empire: 'net use /delete' via PowerShell", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed net.exe executing with command-line arguments. The telemetry was tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because the user Bob removed an artifact for the ADMIN$ share.[CS9]"}], "Screenshots": {"CS-16.C.1-1.png": "Telemetry from process tree showing net.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-10.png": "Excerpt from email sent by OverWatch team indicating they observed ADMIN$ artifact removed (General Behavior)", "": ""}}}}, "T1036": {"TechniqueName": "Masquerading", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\\"Synchronize with Adobe for security updates.\\\". An analyst could use this information to determine it is not a legitimate service. The process tree view showed sc.exe as tainted by a previous powershell.exe detection."}], "Screenshots": {"CS-16.H.1-3.png": "Telemetry from process tree showing sc.exe execution with the AdobeUpdater service description (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-16.H.1-4.png": "Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description", "": ""}}, "19.A.1": {"Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "DetectionCategories": [{"Telemetry": "Telemetry showed the SHA256 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR."}], "Screenshots": {"CS-19.A.1-2.png": "Telemetry showing SHA256 hash of recycler.exe", "": ""}}, "19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "DetectionCategories": [{"Specific Behavior,Tainted": "A Specific Behavior alert was created for a RAR archive \\\"written by a process with suspicious command line arguments.\\\". Details showed that recycler.exe wrote a RAR archive and that recycler.exe was signed by win.rar GmbH. The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection."}, {"Telemetry": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]"}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.[CS9]"}], "Screenshots": {"CS-19.B.1-1.png": "Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-19.B.1-3.png": "Additional alert details showing recycler.exe was signed by win.rar GmbH", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)", "": ""}}}}, "T1050": {"TechniqueName": "New Service", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\\"Synchronize with Adobe for security updates.\\\" The process tree view showed sc.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating they observed a General Behavior because newly created file (AdobeUpdater service in registry) established persistence on the host.[CS9]"}], "Screenshots": {"CS-16.H.1-2.png": "Telemetry from process tree showing sc.exe execution to create the AdobeUpdater service (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-16.H.1-4.png": "Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed a newly created file (AdobeUpdater service in registry) to establish persistence (General Behavior)", "": ""}}}}, "T1035": {"TechniqueName": "Service Execution", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"16.L.1": {"Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed sc.exe executing with command-line arguments to start the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection."}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating they observed a Specific Behavior because update.vbs executed following the start of the AdobeUpdater service.[CS9]"}], "Screenshots": {"CS-16.L.1-1.png": "Telemetry showing sc start in the process tree view (tainted from previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed execution of update.vbs following the AdobeUpdater service start (Specific Behavior)", "": ""}}}}, "T1222": {"TechniqueName": "File Permissions Modification", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"17.B.1": {"Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed takeown.exe executing with command-line arguments. The process tree view showed takeown.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because takeown.exe was executed to bypass Windows logon.[CS9]"}], "Screenshots": {"CS-17.B.1-1.png": "Telemetry from process tree view showing execution of takeown.exe (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed takeown.exe executed to bypass Windows logon (General Behavior)", "": ""}}, "17.B.2": {"Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed execution of icacls.exe with command-line arguments. The process tree view showed icacls.exe as tainted by a previous powershell.exe detection."}, {"General Behavior,Delayed": "The OverWatch team sent an email indicating a General Behavior was observed because icacls.exe was executed to bypass Windows logon.[CS9]"}], "Screenshots": {"CS-17.B.2-1.png": "Telemetry from process tree view showing execution of icacls.exe (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-11.png": "Email excerpt sent by OverWatch team indicating they observed icacls.exe executed to bypass Windows logon (General Behavior)", "": ""}}}}, "T1015": {"TechniqueName": "Accessibility Features", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"17.C.1": {"Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed a file write of magnify.exe by powershell.exe in the system directory. The telemetry was tainted by an alert on its parent powershell.exe process."}], "Screenshots": {"CS-17.C.1-1.png": "Telemetry showing file write of magnify.exe by powershell.exe (tainted by parent powershell.exe high severity alert indicated by red icon)", "CS-17.C.1-2.png": "Additional view of telemetry showing the magnify.exe file write", "": ""}}, "20.A.1": {"Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated on utilman.exe executing magnify.exe, noting that \\\"a process chain bypassed Windows logon security.\\\" The alert was marked critical and was mapped to the correct ATT&CK Technique (Accessibility Features) and Tactic (Persistence). Data in the alert also showed that magnify.exe was identified as cmd.exe based on hash value in the common name field."}, {"Telemetry": "Telemetry within the alert showed the details for magnify.exe, and would also be available in a separate view.[CS2]"}, {"General Behavior,Delayed": "OverWatch generated a General Behavior alert indicating a Windows logon bypass on Creeper was observed.[CS9]"}], "Screenshots": {"CS-20.A.1-1.png": "Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)", "CS-20.A.1-2.png": "File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name", "CS-E-12.png": "Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)", "": ""}}}}, "T1074": {"TechniqueName": "Data Staged", "TacticGroup": "collection", "PrimaryEnabling": "Primary", "Steps": {"18.B.1": {"Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed the .vsdx file being written into the Recycle Bin."}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed the .vsdx file being copied to the Recycle Bin, a \\\"likely location to stage files of interest.\\\"[CS9]"}], "Screenshots": {"CS-18.B.1-1.png": "Telemetry showing the .vsdx being written into the Recycle Bin (event_SimpleName of OoxmlFileWritten)", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed the .vsdx file being copied to Recycle Bin for staging (Specific Behavior)", "": ""}}}}, "T1002": {"TechniqueName": "Data Compressed", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "DetectionCategories": [{"Specific Behavior,Tainted": "A Specific Behavior alert was generated for a RAR archive \\\"written by a process with suspicious command line arguments.\\\" The alert showed the command-line details and was tagged with the correct ATT&CK Technique (Data Compressed) and Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection."}, {"Telemetry": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]"}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating they observed a Specific Behavior because a .vsdx file was archived for likely exfiltration using the renamed RAR binary, recycler.exe.[CS9]"}], "Screenshots": {"CS-19.B.1-1.png": "Specific Behavior alert on RAR archive written (mapped to correct ATT&CK Technique, Data Compressed, and Tactic, Exfiltration; tainted by previous powershell.exe detection by red line indicating high severity)", "CS-19.B.1-3.png": "Additional details of recycler.exe from the alert showing it was signed by win.rar GmbH", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)", "": ""}}}}, "T1022": {"TechniqueName": "Data Encrypted", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "DetectionCategories": [{"Specific Behavior,Tainted": "A Specific Behavior alert was created for a RAR archive \\\"written by a process with suspicious command line arguments.\\\" Details showed the flags -hp within the command line that indicated use of encryption, and the alert was mapped to a related ATT&CK Technique (Data Compressed) and the correct Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection."}, {"Telemetry": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]"}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.[CS9]"}], "Screenshots": {"CS-19.B.1-1.png": "Specific Behavior alert showing use of -hp flags within command-line (mapped to related ATT&CK Technique, Data Compressed, and correct Tactic, Exfiltration; tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)", "": ""}}}}, "T1048": {"TechniqueName": "Exfiltration Over Alternative Protocol", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.C.1": {"Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "DetectionCategories": [{"General Behavior,Delayed,Tainted": "OverWatch generated a General Behavior alert indicating ftp.exe executing with ftp.txt was suspicious. The process tree view showed ftp.exe as tainted by a previous powershell.exe detection.[CS1] "}, {"Telemetry": "Telemetry within the OverWatch alert showed ftp.exe executing with ftp.txt.[CS2]"}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed because collected files were exfiltrated via FTP.[CS9]"}], "Screenshots": {"CS-19.C.1-1.png": "OverWatch General Behavior alert indicating ftp.exe executing with ftp.txt was suspicious (tainted by previous powershell.exe detection by red line indicating high severity)", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed the collected files being exfiltrated via FTP (Specific Behavior)", "": ""}}}}, "T1107": {"TechniqueName": "File Deletion", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"19.D.1": {"Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "DetectionCategories": [{"Telemetry": "Telemetry showed the deletion of old.rar with an event name of FileDeleted."}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed because files (including old.rar) were deleted from the host CodeRed.[CS9]"}], "Screenshots": {"CS-19.D.1-1.png": "Telemetry showing deletion of old.rar", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed old.rar being deleted (Specific Behavior)", "": ""}}, "19.D.2": {"Procedure": "Empire: 'del recycler.exe'", "DetectionCategories": [{"Telemetry": "Telemetry showed the deletion of recycler.exe with an event name of ExecutableDeleted."}, {"Specific Behavior,Delayed": "The OverWatch team sent an email indicating a Specific Behavior was observed because files (including recycler.exe) were deleted from the host CodeRed.[CS9]"}], "Screenshots": {"CS-19.D.1-2.png": "Telemetry showing deletion of recycler.exe", "CS-E-12.png": "Email excerpt sent by OverWatch team indicating they observed recycler.exe being deleted (Specific Behavior)", "": ""}}}}}